create database batch1_orders;

use batch1_orders;


CREATE TABLE SALESMAN (SALESMAN_ID INTEGER PRIMARY KEY,NAME CHAR(20) NOT NULL,CITY CHAR(10),COMISSION DECIMAL(10,2));

CREATE TABLE COUSTMER(COUSTMER_ID INTEGER PRIMARY KEY,CUST_NAME CHAR(20) NOT NULL,CITY CHAR(20),GRADE INTEGER,SALESMAN_ID INTEGER,CONSTRAINT SALESMAN_ID_COUSTMER_FK FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)ON DELETE CASCADE);

CREATE TABLE ORDERS1(ORD_NO INTEGER PRIMARY KEY,PURCHASE_AMT DECIMAL(10,4),ORD_DATE DATE NOT NULL,SALESMAN_ID INTEGER NOT NULL,COUSTMER_ID INTEGER NOT NULL,CONSTRAINT SALESMAN_ID_ORDERS_FK FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)ON DELETE CASCADE,CONSTRAINT COUSTMER_ID_ORDERS_FK FOREIGN KEY (COUSTMER_ID) REFERENCES COUSTMER(COUSTMER_ID) ON DELETE CASCADE);


INSERT INTO SALESMAN VALUES(1000,'AKASH','HASSAN',0.10);
INSERT INTO SALESMAN VALUES(1001,'ADITHI','BANGALORE',0.8);
INSERT INTO SALESMAN VALUES(1002,'MUKESH','MANGALORE',0.12);
INSERT INTO SALESMAN VALUES(1003,'RANI','MYSORE',0.10);
INSERT INTO SALESMAN VALUES(1004,'RAMESH','MANGALORE',0.12); 


INSERT INTO COUSTMER VALUES(2000,'NIKHIL','BANGALORE',100,1001);
INSERT INTO COUSTMER VALUES(2001,'RAKESH','MANGALORE',200,1002);
INSERT INTO COUSTMER VALUES(2002,'ADARSH','MYSORE',100,1001);
INSERT INTO COUSTMER VALUES(2003,'AMAR','BANGALORE',100,1003);
INSERT INTO COUSTMER VALUES(2004,'DINESH','MANGALORE',300,1003);

INSERT INTO ORDERS1 VALUES(1,2000,'2017-09-10',1001,2001);
INSERT INTO ORDERS1 VALUES(2,3400,'2017-09-10',1002,2002);
INSERT INTO ORDERS1 VALUES(3,1200,'2017-08-23',1003,2001);
INSERT INTO ORDERS1 VALUES(4,2040,'2017-08-23',1001,2004);
INSERT INTO ORDERS1 VALUES(5,1000,'2017-08-01',1002,2003);

querIes

Q1
SELECT COUNT(*)FROM COUSTMER C WHERE C.GRADE > (SELECT AVG(GRADE) FROM COUSTMER WHERE CITY='BANGALORE');

Q2
SELECT S.SALESMAN_ID, S.NAME FROM SALESMAN S,COUSTMER C WHERE C.SALESMAN_ID=S.SALESMAN_ID GROUP BY S.SALESMAN_ID HAVING COUNT(*)>1;

Q3
SELECT S.SALESMAN_ID,S.NAME,S.CITY,S.COMISSION FROM SALESMAN S,COUSTMER C 
WHERE C.SALESMAN_ID = S.SALESMAN_ID AND C.CITY = S.CITY 
UNION SELECT S.SALESMAN_ID,S.NAME,S.CITY,S.COMISSION FROM SALESMAN S WHERE NOT EXISTS(SELECT *FROM COUSTMER C WHERE C.CITY=S.CITY AND S.SALESMAN_ID=C.SALESMAN_ID);


Q4
CREATE VIEW MAXSALES_VIEW AS
SELECT S.SALESMAN_ID,S.NAME,O.ORD_DATE,O.COUSTMER_ID
FROM SALESMAN S,ORDERS1 O
WHERE S.SALESMAN_ID=O.SALESMAN_ID AND
O.pURCHASE_AMT=(SELECT MAX(PURCHASE_AMT)
FROM ORDERS1 
WHERE O.ORD_DATE=ORD_DATE GROUP BY ORD_DATE);

Q5
DELETE FROM SALESMAN WHERE SALESMAN_ID =1000;










